--====================================================================================================================================================
-- Строковые функции T-SQL
https://docs.microsoft.com/en-us/sql/t-sql/functions/string-functions-transact-sql?view=sql-server-ver15


-- ASCII ( character_expression ) возвращает код ASCII левого символа строки.
select 't-sql', 
       ascii('t-sql') as [code_value_of_the_eftmost_character ];

select e.JobTitle,
       ascii(e.JobTitle) as [code_value_of_the_eftmost_character]
  from [HumanResources].[Employee] e
 -- where ascii(e.JobTitle)  = 83
 order by [code_value_of_the_eftmost_character] desc
;

-- CHAR  ( integer_expression ) по коду ASCII возвращает символ.
select 't-sql', 
       ascii('t-sql')       as [code_value_of_the_eftmost_character ],
	   char(ascii('t-sql'));

-- CHARINDEX ( expressionToFind , expressionToSearch [ , start_location ] )определяет порядковый номер символа, с которого начинается вхождение подстроки в строку.
select 't-sql-2022',
       charindex('-', 't-sql-2022', 3);

select distinct
       e.JobTitle,
       charindex('-', e.JobTitle)
  from [HumanResources].[Employee] e
 where e.JobTitle like '%-%';

-- LEFT ( character_expression , integer_expression ) возвращает указанное число символов с начала строки.
select 't-sql', 
       left('t-sql', 3);

select distinct
       left(e.[LoginID], 3) as [exp]
  from [HumanResources].[Employee] e
 order by [exp] asc;

-- LEN ( string_expression ) возвращает длину строки. Функция LEN вырезает замыкающие пробельные символы.
select 't-sql', 
       len('   t-sql              '),
	   datalength('    t-sql       ');

select e.JobTitle,
       len(e.JobTitle)*2,
	   datalength(e.JobTitle)
  from [HumanResources].[Employee] e;
 -- where len(e.JobTitle)*2 != datalength(e.JobTitle)

-- LOWER ( character_expression ) переводит все символы строки в нижний регистр.
select 'T-SQL', lower('T-SQL');

select e.JobTitle,
       lower(e.JobTitle)
  from [HumanResources].[Employee] e
 where lower(e.JobTitle) = 'engineering manager';


-- LTRIM ( character_expression ) удаляет пробелы в начале строки.
select '      t-sql', ltrim('      t-sql');

select e.JobTitle
  from [HumanResources].[Employee] e
 where e.JobTitle = ltrim('   engineering manager'); 

-- NCHAR ( integer_expression )возвращает по коду символ Unicode.
select nchar(1025);
select unicode(N'Ёлки');

select distinct 
       e.JobTitle,
       unicode(lower(e.JobTitle)) as "exp"
  from [HumanResources].[Employee] e
 order by "exp" desc;

-- PATINDEX( '%pattern%' , expression )выполняет поиск подстроки в строке по указанному шаблону.
select 'T-SQL-2022', patindex('%-2022', 'T-SQL-2022');

select e.JobTitle,
       patindex('%[1234567890]%', e.JobTitle)
  from [HumanResources].[Employee] e
;

-- REPLACE ( string_expression , string_pattern , string_replacement )заменяет вхождения подстроки на указанное значение.
select replace('      t      sql     ', ' ', '');

select e.JobTitle,
       replace(e.JobTitle, 'WC', '')
  from [HumanResources].[Employee] e
;

-- REPLICATE ( string_expression ,integer_expression ) выполняет тиражирование строки определенное число раз.
select 'T-SQL', REPLICATE('T-SQL', 3), replicate(' ', 100);

select e.JobTitle,
       replicate(e.JobTitle, 3)
  from [HumanResources].[Employee] e
;

-- REVERSE ( string_expression )возвращает строку, символы которой записаны в обратном порядке.
select 't-sql', reverse('t-sql');

select e.JobTitle,
       reverse(e.JobTitle)
  from [HumanResources].[Employee] e
;

-- RIGHT ( character_expression , integer_expression ) возвращает указанное число символов с конца строки.
select 't-sql', right('t-sql', 3);

select e.JobTitle,
       right(e.JobTitle, 3)
  from [HumanResources].[Employee] e 
 where right(e.JobTitle, 3) in ('ger', 'ner', 'eer');

select c.*
  from [Sales].[CreditCard] c
 where right(c.CardNumber, 2) in ('10', '22', '53', '48');

-- RTRIM ( character_expression )удаляет пробелы в конце строки.
select '      t-sql     ', rtrim('      t      sql     ');

-- SPACE ( integer_expression )возвращает указанное число пробелов.
select space(300);

-- STR ( float_expression [ , length [ , decimal ] ] ) выполняет конвертирование значения числового типа в символьный формат.
select str(99.54, 4, 1) + ' - it''s a string'; 

-- STUFF ( character_expression , start , length , replaceWith_expression )удаляет указанное число символов, заменяя новой подстрокой.
select '55553252134216', stuff('55553252134216', 5, 6,'******');

select c.CardNumber,
       stuff(c.CardNumber, 5, 6,'******')
  from [Sales].[CreditCard] c;

-- SUBSTRING ( expression ,start , length ) возвращает для строки подстроку указанной длины с заданного символа.
select c.CardNumber,
       substring(c.CardNumber, 5, 6)
  from [Sales].[CreditCard] c;

-- UNICODE ( ncharacter_expression ) возвращает Unicode-код левого символа строки.
select unicode(N'Ёлки');

-- UPPER ( character_expression ) переводит все символы строки в верхний регистр.
select 't-sql', upper('t-sql');

select upper(e.JobTitle)
  from [HumanResources].[Employee] e;

-- CONCAT Эта функция возвращает строку, возникающую в результате объединения двух или более строковых значений в сквозной форме.
-- CONCAT_WS Эта функция возвращает строку, возникающую в результате объединения двух или более строковых значений в сквозной форме. 
-- Она разделяет значения в такой объединенной строке с помощью разделителя, указанного в первом аргументе функции. (Название функции CONCAT_WS означает сцепить с разделителем.)
select 't'+'-'+'sql'+null + str(1,1,0) ,
       concat('t', '-', null,'sql', 1),
	   concat_ws('_', 't', '-', null,'sql', 1);

select p.Title,
       p.LastName,
	   p.FirstName,
	   p.MiddleName,
       p.Title + p.LastName + p.FirstName + p.MiddleName as [FullName],
	   concat(p.Title, p.LastName, p.FirstName, p.MiddleName) as [FullNameConcat],

	   upper(concat_ws(' ', p.Title, p.LastName, p.FirstName, p.MiddleName)) as [FullNameConcatWS]
  from [Person].[Person] p;

-- QUOTENAME 
select QUOTENAME('t-sql', '"');

-- FORMAT
DECLARE @d DATE = '11/22/2020';
SELECT FORMAT( @d, 'd', 'en-US' ) 'US English'  
      ,FORMAT( @d, 'd', 'en-gb' ) 'Great Britain English'  
      ,FORMAT( @d, 'd', 'de-de' ) 'German'  
      ,FORMAT( @d, 'd', 'zh-cn' ) 'Simplified Chinese (PRC)';  
  
SELECT FORMAT( @d, 'D', 'en-US' ) 'US English'  
      ,FORMAT( @d, 'D', 'en-gb' ) 'Great Britain English'  
      ,FORMAT( @d, 'D', 'de-de' ) 'German'  
      ,FORMAT( @d, 'D', 'zh-cn' ) 'Chinese (Simplified PRC)';  

select "period" = quotename(format(o.OrderDate, 'yyyyMM', 'en-US')),
       "qty" = count(distinct o.SalesOrderID)
  from [Sales].[SalesOrderHeader] o
 group by quotename(format(o.OrderDate, 'yyyyMM', 'en-US'))
 order by "period" desc;

-- STRING_AGG
		select q.CardType,
			   string_agg(convert(varchar(max), [last4]), ',') within group (order by convert(varchar(max), [last4]) desc) as [ConcatanatedRow]
		  from (select distinct 
					   c.CardType,
					   right(c.CardNumber,4) as [last4]
				  from [Sales].[CreditCard] c) q
		  group by q.CardType;

-- STRING_SPLIT 
DECLARE @CardLast4 NVARCHAR(400) = '9998,9996,9991,9989,9988,9983,9978,9977,9976,9974,9973,9972,9971,9969,9968,9967,9966,9965,9961,9959,9956,9954,9951,9948,9946,9944,9943,9940,9939,9938,9935,9931,9930,9927,9922,9920,9919,9918,9917,9912,9911,9910,9908,9899,9895,9894,9891,9890,9888,9885,9884,9883,9880,9878,9875,9873,9870,9866,9864,9859,9855,9851,9849,9848,9847,9846,9845,9844,9843,9842,9840,9838,9830,9829,9825,9824,9817,9813,9812,9807,9806,9803,9801,9799,9796,9793,9792,9790,9784,9780,9777,9776,9775,9773,9771,9762,9760,9755,9751,9745,9729,9728,9726,9719,9717,9713,9711,9710,9709,9708,9706,9700,9699,9692,9689,9688,9685,9679,9678,9676,9675,9671,9669,9667,9666,9665,9662,9656,9655,9652,9649,9647,9646,9643,9642,9639,9633,9631,9628,9624,9623,9618,9613,9612,9611,9609,9602,9599,9597,9594,9591,9587,9586,9584,9579,9577,9576,9573,9570,9565,9562,9560,9557,9555,9554,9553,9552,9546,9544,9542,9541,9540,9537,9534,9531,9529,9528,9527,9526,9525,9523,9521,9519,9517,9516,9515,9513,9511,9500,9499,9496,9492,9487,9486,9484,9483,9482,9480,9479,9476,9475,9474,9471,9465,9463,9460,9455,9443,9441,9437,9430,9428,9423,9422,9421,9418,9417,9416,9412,9411,9408,9407,9405,9402,9398,9396,9395,9394,9391,9388,9386,9385,9384,9382,9381,9377,9369,9365,9363,9361,9358,9354,9351,9345,9344,9343,9342,9341,9340,9339,9335,9330,9323,9322,9320,9319,9317,9315,9313,9310,9309,9298,9295,9294,9290,9289,9281,9277,9272,9270,9268,9267,9266,9262,9261,9258,9253,9248,9247,9246,9245,9242,9239,9237,9235,9233,9232,9230,9226,9222,9221,9220,9216,9215,9210,9207,9206,9205,9204,9200,9199,9197,9195,9192,9183,9181,9180,9179,9176,9174,9173,9164,9162,9161,9160,9158,9156,9153,9152,9148,9144,9140,9136,9135,9134,9133,9130,9125,9124,9120,9119,9118,9109,9106,9105,9102,9094,9091,9090,9089,9087,9085,9083,9081,9078,9077,9076,9072,9070,9064,9061,9060,9059,9056,9055,9054,9053,9052,9050,9049,9042,9039,9038,9037,9036,9032,9024,9022,9021,9020,9013,9012,9010,9007,9004,9003,9002,9001,8999,8995,8994,8992,8987,8986,8985,8983,8978,8975,8973,8972,8966,8964,8963,8961,8958,8955,8944,8943,8939,8937,8935,8933,8930,8929,8927,8926,8925,8920,8918,8916,8915,8911,8908,8906,8902,8901,8900,8894,8893,8891,8889,8884,8883,8879,8877,8876,8871,8868,8866,8860,8850,8846,8844,8842,8841,8837,8836,8835,8830,8827,8825,8824,8821,8819,8817,8811,8807,8803,8802,8801,8799,8795,8793,8791,8789,8780,8777,8776,8775,8768,8762,8758,8756,8755,8754,8753,8752,8751,8749,8742,8739,8738,8737,8734,8733,8731,8730,8726,8722,8720,8718,8716,8712,8710,8705,8701,8698,8696,8694,8692,8689,8686,8683,8682,8680,8678,8673,8666,8658,8654,8650,8644,8643,8641,8640,8635,8634,8632,8625,8622,8620,8619,8616,8608,8607,8605,8600,8596,8590,8589,8585,8582,8575,8574,8573,8566,8560,8558,8556,8555,8552,8549,8548,8546,8541,8540,8539,8538,8537,8536,8529,8527,8526,8525,8524,8523,8519,8518,8515,8513,8512,8508,8506,8505,8496,8494,8493,8488,8480,8476,8474,8473,8468,8466,8464,8462,8456,8455,8452,8451,8447,8446,8445,8440,8433,8432,8431,8424,8423,8417,8416,8415,8414,8412,8409,8408,8407,8403,8401,8400,8397,8391,8390,8387,8385,8383,8382,8378,8376,8375,8366,8365,8364,8360,8355,8353,8352,8351,8350,8342,8340,8336,8334,8330,8326,8324,8322,8321,8317,8316,8312,8301,8299,8297,8292,8291,8286,8283,8282,8279,8276,8271,8269,8268,8267,8265,8264,8257,8254,8252,8251,8248,8244,8243,8242,8241,8239,8238,8237,8231,8224,8220,8219,8216,8215,8214,8213,8212,8211,8210,8209,8207,8199,8196,8195,8193,8192,8191,8190,8183,8181,8178,8174,8173,8171,8169,8168,8162,8161,8160,8159,8158,8156,8154,8152,8149,8145,8141,8136,8131,8128,8127,8124,8121,8120,8116,8114,8111,8103,8101,8099,8098,8097,8095,8093,8083,8082,8081,8074,8073,8071,8070,8067,8065,8064,8062,8059,8056,8050,8048,8043,8041,8039,8035,8034,8028,8027,8026,8024,8020,8017,8015,8012,8011,8010,8009,8008,8004,8003,7999,7998,7995,7991,7988,7984,7983,7981,7980,7978,7977,7976,7973,7966,7960,7959,7956,7955,7954,7953,7946,7945,7943,7941,7940,7935,7932,7931,7928,7924,7919,7916,7913,7907,7906,7905,7903,7902,7898,7897,7896,7894,7893,7890,7889,7886,7883,7880,7879,7875,7864,7863,7862,7861,7860,7859,7857,7850,7847,7846,7844,7842,7841,7840,7837,7831,7830,7829,7824,7823,7817,7816,7813,7812,7811,7807,7805,7800,7797,7791,7788,7787,7785,7779,7778,7777,7770,7766,7764,7763,7761,7760,7753,7752,7750,7745,7740,7735,7734,7733,7727,7721,7719,7718,7712,7704,7703,7701,7700,7699,7697,7696,7695,7694,7684,7681,7680,7679,7674,7669,7668,7665,7662,7661,7659,7658,7656,7654,7653,7651,7649,7645,7643,7639,7634,7633,7624,7623,7621,7619,7615,7613,7611,7610,7608,7601,7597,7591,7587,7585,7584,7583,7578,7576,7564,7561,7560,7559,7558,7557,7553,7551,7550,7549,7548,7547,7545,7544,7541,7539,7538,7531,7524,7521,7516,7511,7510,7509,7506,7505,7503,7501,7499,7498,7496,7494,7492,7490,7485,7483,7482,7479,7478,7476,7475,7473,7470,7467,7463,7461,7456,7455,7453,7452,7451,7448,7446,7442,7440,7436,7421,7420,7419,7418,7415,7414,7412,7410,7409,7402,7399,7396,7394,7393,7386,7385,7375,7374,7371,7366,7363,7360,7359,7358,7356,7353,7347,7346,7345,7336,7335,7334,7333,7332,7331,7328,7326,7325,7320,7319,7317,7316,7313,7310,7307,7306,7305,7304,7293,7288,7286,7283,7282,7281,7278,7273,7272,7269,7268,7266,7263,7261,7260,7250,7249,7248,7244,7241,7239,7235,7234,7226,7224,7221,7220,7218,7215,7213,7212,7211,7210,7209,7207,7206,7203,7201,7200,7199,7198,7195,7193,7190,7186,7184,7183,7182,7181,7180,7178,7176,7175,7174,7170,7169,7168,7166,7165,7162,7159,7158,7155,7142,7141,7140,7138,7137,7135,7134,7132,7131,7129,7126,7125,7118,7117,7111,7108,7106,7105,7101,7093,7091,7089,7088,7084,7081,7080,7077,7070,7069,7060,7058,7055,7054,7051,7049,7048,7047,7046,7044,7043,7039,7038,7036,7033,7031,7030,7026,7023,7022,7019,7018,7014,7013,7012,7011,7008,7005,7003,6998,6995,6994,6991,6989,6988,6986,6984,6980,6975,6973,6970,6969,6968,6966,6960,6959,6958,6953,6952,6950,6946,6945,6943,6941,6939,6938,6935,6933,6931,6929,6928,6927,6926,6923,6922,6920,6919,6917,6911,6908,6905,6898,6897,6896,6895,6891,6889,6888,6883,6881,6877,6875,6873,6872,6871,6870,6863,6862,6861,6859,6857,6855,6854,6853,6852,6851,6850,6848,6847,6845,6843,6841,6836,6829,6823,6821,6819,6818,6812,6810,6807,6805,6799,6795,6791,6789,6788,6787,6783,6782,6779,6778,6776,6775,6774,6768,6766,6765,6764,6762,6761,6757,6756,6754,6753,6748,6747,6745,6740,6739,6737,6734,6724,6723,6721,6718,6712,6707,6704,6702,6701,6700,6699,6696,6693,6692,6691,6683,6680,6671,6667,6663,6661,6658,6656,6653,6649,6648,6647,6636,6635,6631,6628,6626,6625,6622,6620,6616,6615,6607,6606,6604,6601,6599,6595,6593,6591,6590,6588,6585,6583,6581,6579,6574,6573,6572,6570,6569,6561,6560,6557,6556,6552,6549,6548,6546,6540,6534,6533,6530,6528,6526,6517,6508,6507,6502,6500,6494,6490,6488,6486,6484,6482,6476,6475,6473,6471,6469,6467,6464,6460,6457,6451,6448,6447,6446,6445,6443,6441,6438,6435,6434,6427,6421,6416,6410,6409,6408,6403,6402,6401,6399,6398,6396,6394,6392,6388,6387,6384,6383,6382,6380,6378,6377,6376,6375,6374,6371,6370,6364,6363,6358,6357,6351,6350,6349,6347,6345,6344,6336,6334,6331,6324,6319,6317,6316,6314,6310,6309,6308,6307,6306,6305,6304,6303,6299,6296,6295,6292,6290,6289,6288,6284,6281,6275,6270,6264,6253,6252,6244,6241,6240,6239,6237,6228,6226,6225,6223,6222,6221,6220,6217,6215,6212,6211,6205,6203,6202,6199,6198,6190,6189,6186,6181,6179,6173,6172,6170,6167,6166,6159,6157,6151,6147,6146,6144,6139,6133,6130,6122,6121,6118,6115,6114,6113,6105,6102,6099,6096,6091,6090,6089,6086,6082,6077,6076,6067,6066,6062,6059,6055,6052,6048,6047,6045,6044,6038,6031,6029,6027,6025,6023,6019,6017,6015,6012,6010,6009,6005,6004,5999,5998,5997,5991,5990,5987,5986,5985,5983,5982,5981,5980,5977,5973,5972,5967,5965,5957,5955,5954,5952,5949,5948,5947,5945,5944,5942,5940,5939,5938,5937,5934,5930,5922,5915,5910,5909,5907,5905,5904,5903,5901,5896,5895,5887,5886,5881,5877,5873,5871,5863,5860,5858,5857,5854,5849,5845,5843,5840,5838,5834,5833,5832,5829,5827,5826,5823,5822,5819,5809,5805,5803,5798,5795,5793,5792,5791,5790,5786,5785,5783,5782,5780,5776,5774,5765,5757,5751,5749,5747,5745,5744,5741,5740,5737,5736,5735,5733,5728,5727,5726,5724,5718,5715,5709,5708,5705,5703,5699,5697,5695,5692,5687,5686,5685,5680,5672,5666,5665,5661,5660,5657,5656,5655,5654,5644,5642,5640,5639,5634,5633,5632,5631,5629,5626,5619,5618,5616,5615,5614,5612,5602,5596,5594,5593,5592,5590,5582,5580,5577,5575,5574,5571,5567,5566,5562,5560,5556,5555,5552,5547,5544,5540,5539,5535,5534,5532,5531,5529,5528,5526,5522,5521,5520,5517,5516,5513,5511,5507,5506,5497,5495,5492,5491,5490,5489,5484,5479,5478,5477,5475,5474,5470,5468,5457,5453,5451,5449,5448,5444,5443,5441,5435,5432,5425,5421,5418,5416,5413,5411,5410,5406,5401,5398,5395,5394,5393,5391,5390,5389,5386,5383,5382,5377,5376,5374,5369,5368,5366,5362,5359,5358,5356,5354,5347,5344,5330,5324,5322,5316,5315,5314,5312,5309,5304,5302,5301,5300,5298,5296,5291,5285,5277,5276,5274,5272,5269,5266,5264,5258,5255,5253,5252,5251,5250,5248,5246,5245,5243,5242,5239,5236,5235,5231,5228,5227,5219,5218,5215,5213,5211,5210,5209,5207,5205,5204,5203,5202,5199,5197,5195,5188,5186,5181,5176,5172,5169,5167,5164,5162,5159,5154,5149,5148,5142,5131,5129,5127,5125,5123,5121,5120,5119,5118,5115,5112,5110,5109,5108,5105,5098,5096,5092,5091,5086,5085,5084,5083,5081,5077,5074,5071,5065,5063,5061,5058,5056,5054,5049,5043,5040,5037,5036,5028,5025,5021,5020,5019,5017,5016,5013,5012,5010,5008,5004,4996,4994,4992,4991,4989,4980,4978,4976,4975,4974,4973,4970,4966,4965,4964,4962,4961,4959,4958,4957,4954,4953,4949,4948,4942,4941,4933,4931,4929,4927,4925,4924,4919,4918,4915,4913,4905,4904,4903,4902,4898,4896,4895,4894,4892,4888,4887,4885,4882,4881,4880,4879,4872,4871,4870,4868,4867,4859,4857,4854,4853,4852,4851,4850,4845,4843,4842,4841,4837,4836,4835,4834,4831,4829,4828,4825,4821,4820,4813,4808,4799,4795,4794,4785,4777,4776,4770,4769,4768,4767,4763,4762,4761,4759,4758,4753,4751,4748,4747,4743,4736,4733,4729,4726,4722,4720,4716,4713,4704,4703,4702,4699,4698,4697,4693,4690,4688,4683,4682,4679,4678,4677,4674,4673,4671,4669,4666,4664,4663,4661,4660,4658,4657,4656,4652,4651,4648,4647,4645,4639,4638,4637,4635,4632,4628,4623,4622,4621,4620,4619,4617,4613,4611,4607,4603,4597,4591,4589,4588,4587,4586,4583,4582,4579,4577,4575,4574,4573,4569,4568,4565,4562,4561,4559,4558,4555,4552,4547,4545,4544,4543,4542,4538,4535,4534,4531,4527,4526,4523,4521,4520,4516,4512,4511,4508,4505,4503,4502,4494,4492,4482,4481,4480,4479,4476,4475,4473,4470,4466,4465,4457,4456,4454,4450,4449,4444,4443,4441,4437,4435,4434,4433,4432,4430,4427,4423,4422,4421,4414,4413,4407,4406,4400,4398,4397,4395,4394,4391,4390,4389,4387,4386,4384,4379,4377,4376,4373,4370,4362,4361,4360,4358,4356,4355,4354,4353,4352,4350,4349,4348,4347,4345,4342,4341,4339,4338,4335,4334,4333,4332,4327,4326,4325,4324,4323,4322,4321,4314,4310,4308,4307,4306,4302,4301,4299,4297,4295,4294,4293,4290,4287,4285,4283,4282,4280,4276,4273,4266,4265,4261,4257,4256,4255,4251,4244,4241,4239,4238,4237,4236,4235,4234,4233,4232,4230,4226,4225,4222,4221,4216,4215,4213,4210,4205,4199,4194,4192,4189,4188,4186,4183,4180,4177,4170,4167,4165,4163,4162,4161,4157,4155,4154,4149,4148,4146,4145,4144,4142,4140,4139,4135,4133,4128,4127,4126,4123,4122,4120,4119,4118,4117,4115,4106,4105,4100,4099,4098,4089,4088,4079,4078,4077,4076,4073,4072,4068,4066,4062,4061,4056,4055,4053,4052,4050,4049,4048,4046,4043,4040,4038,4036,4034,4030,4029,4026,4025,4021,4015,4014,4013,4012,4011,4009,4008,4007,4004,4002,4000,3998,3997,3995,3994,3991,3990,3989,3988,3985,3981,3980,3979,3977,3975,3974,3973,3971,3969,3965,3962,3959,3952,3948,3943,3942,3937,3935,3932,3927,3926,3923,3920,3915,3913,3910,3909,3906,3904,3901,3900,3891,3889,3886,3884,3883,3882,3875,3872,3871,3870,3867,3866,3865,3864,3860,3859,3858,3849,3847,3840,3838,3827,3825,3824,3822,3821,3819,3816,3815,3814,3813,3812,3810,3808,3807,3803,3802,3801,3800,3796,3795,3792,3785,3780,3779,3777,3776,3769,3766,3765,3759,3755,3749,3744,3741,3737,3732,3731,3730,3728,3725,3720,3719,3718,3716,3712,3704,3701,3700,3697,3696,3694,3693,3688,3687,3683,3682,3681,3673,3671,3669,3666,3661,3660,3659,3652,3651,3650,3647,3643,3638,3637,3634,3630,3629,3628,3627,3626,3624,3621,3620,3616,3615,3613,3610,3608,3607,3606,3603,3598,3592,3590,3587,3584,3580,3576,3573,3572,3571,3569,3566,3561,3560,3557,3555,3554,3553,3545,3544,3542,3541,3534,3529,3528,3526,3525,3524,3523,3522,3521,3519,3515,3511,3507,3505,3502,3501,3500,3496,3495,3494,3493,3491,3487,3486,3485,3483,3482,3481,3476,3472,3469,3467,3465,3462,3461,3460,3458,3453,3451,3450,3446,3443,3442,3439,3437,3434,3432,3431,3430,3426,3425,3424,3421,3414,3413,3412,3407,3405,3404,3402,3394,3393,3390,3389,3388,3386,3380,3379,3376,3374,3373,3372,3366,3360,3359,3354,3351,3350,3349,3348,3345,3343,3336,3333,3332,3327,3326,3324,3323,3322,3318,3316,3314,3313,3311,3309,3308,3306,3304,3303,3298,3296,3294,3293,3291,3290,3285,3282,3281,3280,3277,3276,3273,3272,3267,3266,3265,3261,3260,3259,3256,3254,3253,3252,3251,3248,3247,3246,3245,3243,3238,3237,3235,3232,3227,3220,3217,3216,3214,3213,3212,3211,3210,3203,3202,3196,3189,3188,3178,3172,3171,3170,3169,3168,3166,3165,3164,3163,3162,3160,3158,3155,3151,3149,3148,3147,3144,3142,3141,3140,3138,3137,3136,3134,3132,3129,3124,3122,3121,3120,3118,3115,3113,3111,3110,3109,3108,3107,3106,3105,3102,3100,3097,3094,3093,3092,3088,3085,3084,3080,3079,3078,3077,3074,3057,3056,3055,3053,3052,3049,3043,3041,3034,3032,3031,3028,3025,3023,3021,3013,3012,3009,3007,3006,3005,3004,2998,2997,2992,2991,2986,2983,2982,2978,2973,2971,2967,2965,2964,2954,2952,2950,2946,2942,2939,2938,2937,2934,2931,2929,2928,2927,2926,2925,2923,2917,2910,2907,2904,2894,2893,2888,2886,2883,2881,2880,2878,2877,2875,2874,2870,2867,2865,2862,2861,2860,2859,2856,2855,2853,2852,2851,2848,2847,2846,2842,2841,2838,2835,2833,2830,2826,2825,2813,2811,2809,2801,2799,2798,2795,2793,2791,2785,2782,2778,2775,2768,2767,2766,2765,2762,2760,2757,2752,2740,2738,2737,2730,2727,2720,2719,2716,2715,2714,2712,2708,2706,2704,2702,2701,2700,2698,2697,2695,2691,2689,2688,2686,2684,2681,2678,2677,2671,2669,2667,2666,2662,2661,2658,2657,2656,2655,2654,2653,2650,2649,2648,2647,2643,2641,2640,2638,2635,2634,2632,2629,2626,2623,2621,2620,2618,2612,2604,2602,2598,2597,2596,2588,2585,2580,2579,2578,2573,2571,2570,2568,2564,2562,2560,2557,2555,2549,2548,2542,2539,2530,2527,2520,2519,2513,2508,2499,2491,2488,2486,2485,2481,2480,2477,2476,2475,2474,2471,2470,2468,2465,2463,2460,2459,2458,2457,2456,2454,2451,2450,2443,2442,2439,2438,2437,2435,2434,2433,2432,2431,2430,2428,2427,2426,2422,2421,2418,2414,2405,2402,2400,2398,2397,2391,2390,2387,2378,2377,2376,2363,2362,2358,2357,2354,2353,2348,2346,2345,2344,2341,2340,2338,2336,2334,2331,2330,2326,2322,2314,2313,2312,2310,2309,2308,2303,2298,2297,2291,2290,2286,2283,2280,2279,2274,2269,2268,2266,2265,2260,2259,2257,2253,2252,2244,2243,2242,2241,2239,2237,2233,2230,2229,2228,2223,2220,2218,2216,2215,2213,2212,2211,2210,2206,2201,2200,2199,2198,2197,2195,2192,2189,2188,2185,2183,2180,2179,2178,2177,2176,2172,2171,2170,2164,2156,2155,2154,2151,2149,2146,2140,2138,2135,2134,2129,2124,2120,2119,2112,2110,2108,2107,2106,2105,2100,2099,2098,2091,2089,2088,2086,2081,2080,2077,2076,2075,2072,2069,2068,2067,2066,2063,2061,2053,2049,2048,2047,2044,2042,2038,2035,2033,2030,2023,2022,2020,2015,2014,2012,2010,2006,2003,1995,1991,1990,1988,1987,1985,1978,1972,1964,1962,1959,1956,1950,1944,1942,1940,1935,1934,1933,1930,1928,1927,1924,1915,1914,1912,1910,1909,1908,1907,1904,1902,1901,1899,1898,1894,1888,1887,1884,1883,1882,1874,1870,1866,1862,1856,1852,1849,1843,1841,1834,1833,1830,1828,1824,1823,1822,1817,1816,1812,1811,1806,1805,1804,1803,1802,1799,1798,1797,1795,1794,1791,1790,1789,1788,1786,1784,1780,1778,1772,1770,1766,1757,1750,1746,1739,1738,1734,1733,1731,1726,1723,1721,1718,1717,1715,1714,1712,1708,1700,1695,1693,1692,1691,1686,1684,1682,1680,1674,1672,1669,1668,1666,1664,1656,1655,1654,1651,1650,1648,1643,1642,1639,1638,1634,1632,1623,1621,1620,1619,1611,1609,1608,1607,1600,1596,1595,1594,1589,1588,1581,1578,1572,1568,1567,1566,1564,1563,1562,1560,1559,1556,1554,1551,1550,1549,1548,1546,1536,1535,1534,1530,1529,1526,1525,1524,1523,1521,1511,1510,1508,1505,1504,1500,1495,1494,1491,1490,1486,1484,1479,1475,1472,1471,1469,1467,1465,1462,1459,1457,1456,1455,1454,1450,1443,1441,1440,1434,1431,1426,1425,1421,1419,1418,1414,1413,1411,1410,1402,1401,1396,1394,1389,1388,1386,1383,1381,1379,1374,1372,1369,1368,1367,1366,1365,1362,1361,1360,1359,1356,1351,1349,1345,1343,1341,1337,1332,1331,1323,1321,1318,1316,1314,1313,1305,1304,1299,1298,1294,1293,1291,1286,1282,1278,1276,1274,1271,1265,1257,1254,1253,1250,1249,1246,1234,1230,1229,1224,1223,1222,1221,1220,1218,1217,1216,1212,1209,1208,1205,1200,1196,1189,1188,1186,1184,1183,1182,1177,1175,1173,1170,1166,1164,1163,1162,1161,1160,1159,1156,1152,1146,1139,1138,1133,1128,1124,1121,1120,1118,1117,1115,1114,1110,1108,1107,1105,1103,1101,1100,1097,1096,1093,1087,1086,1085,1084,1082,1081,1080,1078,1077,1074,1073,1072,1071,1070,1066,1065,1064,1063,1054,1047,1042,1032,1029,1024,1022,1021,1018,1015,1014,1007,1006,1003,1001,0997,0995,0994,0991,0990,0984,0983,0980,0976,0975,0974,0971,0966,0965,0962,0960,0959,0957,0952,0951,0948,0947,0946,0943,0940,0939,0933,0928,0922,0920,0918,0914,0913,0909,0906,0902,0899,0897,0896,0895,0892,0888,0887,0885,0884,0880,0879,0878,0876,0875,0873,0872,0871,0870,0866,0865,0862,0858,0855,0850,0849,0847,0844,0843,0840,0839,0838,0837,0836,0833,0832,0830,0826,0821,0820,0817,0814,0811,0810,0808,0807,0806,0800,0797,0796,0794,0792,0790,0789,0785,0781,0780,0778,0776,0775,0774,0772,0768,0767,0765,0763,0759,0758,0754,0753,0751,0750,0747,0741,0736,0734,0732,0729,0728,0723,0722,0719,0718,0715,0714,0710,0709,0704,0702,0700,0696,0695,0693,0691,0688,0686,0685,0684,0679,0675,0672,0670,0669,0667,0666,0665,0664,0659,0657,0655,0649,0641,0640,0639,0636,0634,0631,0630,0624,0623,0620,0619,0606,0601,0600,0594,0593,0592,0589,0587,0586,0584,0583,0579,0575,0574,0573,0572,0567,0565,0564,0554,0553,0552,0549,0545,0543,0536,0534,0531,0529,0528,0527,0526,0523,0522,0519,0518,0516,0515,0513,0506,0503,0498,0497,0495,0493,0492,0491,0490,0489,0488,0486,0485,0484,0480,0477,0476,0471,0469,0467,0465,0463,0461,0456,0453,0451,0450,0449,0448,0445,0441,0437,0436,0433,0432,0431,0425,0421,0420,0418,0417,0408,0404,0402,0399,0393,0392,0385,0383,0380,0379,0377,0376,0370,0368,0366,0363,0362,0361,0360,0356,0355,0354,0353,0351,0347,0340,0338,0337,0335,0334,0329,0327,0326,0317,0315,0309,0306,0302,0296,0295,0294,0293,0292,0290,0286,0283,0282,0281,0279,0277,0276,0274,0272,0270,0262,0261,0258,0257,0256,0255,0254,0252,0246,0245,0244,0243,0242,0240,0234,0230,0229,0227,0226,0224,0222,0208,0207,0206,0203,0202,0201,0200,0199,0198,0196,0194,0193,0192,0190,0188,0184,0183,0180,0178,0177,0176,0174,0172,0171,0168,0167,0165,0164,0163,0162,0154,0151,0150,0149,0148,0145,0141,0136,0134,0130,0129,0128,0127,0122,0121,0116,0111,0109,0100,0099,0098,0096,0094,0090,0089,0088,0087,0078,0070,0069,0065,0062,0061,0056,0055,0054,0052,0051,0048,0047,0046,0045,0043,0038,0034,0033,0031,0030,0028,0027,0025,0024,0021,0020,0019,0015,0013,0011,0010,0009,0005';
  
SELECT value  
FROM STRING_SPLIT(@CardLast4, ',');
--======================================================================================================================================================================================================
select * from [Sales].[CreditCard];


select 't-sql', RIGHT('t-sql', 3)
